# ã‚¹ã‚­ãƒ¼ãƒç§»è¡Œã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡
1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç§»è¡Œå‰ã®æº–å‚™](#ç§»è¡Œå‰ã®æº–å‚™)
3. [ç§»è¡Œæ‰‹é †](#ç§»è¡Œæ‰‹é †)
4. [ç§»è¡Œå¾Œã®ç¢ºèª](#ç§»è¡Œå¾Œã®ç¢ºèª)
5. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
6. [ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †](#ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †)

---

## ğŸ¯ æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰æ–°ã—ã„ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ç®¡ç†è¨­è¨ˆã¸ã®ç§»è¡Œã‚’è¡Œã„ã¾ã™ã€‚

### ç§»è¡Œã®ç›®çš„
- æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’1-5ã§å›ºå®šç®¡ç†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸­å¿ƒã®å±¥æ­´ç®¡ç†
- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆãƒ»è«–æ–‡æ¤œç´¢å±¥æ­´
- ã‚ˆã‚Šæ˜ç¢ºãªãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ç§»è¡Œå¯¾è±¡
- æ—¢å­˜ã®`practice_*`ãƒ†ãƒ¼ãƒ–ãƒ« â†’ æ–°ã—ã„`exercise_*`ãƒ†ãƒ¼ãƒ–ãƒ«
- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥å±¥æ­´ç®¡ç†ã®è¿½åŠ 
- ãƒ¦ãƒ¼ã‚¶ãƒ¼çµ±è¨ˆã®æœ€é©åŒ–

---

## ğŸ”§ ç§»è¡Œå‰ã®æº–å‚™

### 1. ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª

```sql
-- æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¢ºèª
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name LIKE 'practice_%';

-- ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã®ç¢ºèª
SELECT 
    'practice_sessions' as table_name, COUNT(*) as count FROM practice_sessions
UNION ALL
SELECT 'practice_inputs', COUNT(*) FROM practice_inputs
UNION ALL
SELECT 'practice_scores', COUNT(*) FROM practice_scores
UNION ALL
SELECT 'practice_feedback', COUNT(*) FROM practice_feedback;
```

### 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ä½œæˆ

```sql
-- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
CREATE TABLE practice_sessions_backup AS SELECT * FROM practice_sessions;
CREATE TABLE practice_inputs_backup AS SELECT * FROM practice_inputs;
CREATE TABLE practice_scores_backup AS SELECT * FROM practice_scores;
CREATE TABLE practice_feedback_backup AS SELECT * FROM practice_feedback;
```

### 3. ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_anon_key
OPENAI_API_KEY=your_openai_api_key
```

---

## ğŸš€ ç§»è¡Œæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã®ä½œæˆ

```sql
-- docs/create_new_category_based_schema_fixed.sqlã‚’å®Ÿè¡Œ
-- ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã®å®Œå…¨ãªå®šç¾©ãŒå«ã¾ã‚Œã¦ã„ã¾ã™
```

### ã‚¹ãƒ†ãƒƒãƒ—2: åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥

```sql
-- æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®æŒ¿å…¥
INSERT INTO exercise_categories (category_id, category_name, display_name, description, icon, color, sort_order) VALUES
(1, 'adoption_exam', 'æ¡ç”¨è©¦é¨“', 'åŒ»å¸«æ¡ç”¨è©¦é¨“å¯¾ç­–ã®æ¼”ç¿’', 'ğŸ“‹', '#3B82F6', 1),
(2, 'essay_writing', 'å°è«–æ–‡', 'å°è«–æ–‡å¯¾ç­–ã®æ¼”ç¿’', 'âœï¸', '#10B981', 2),
(3, 'interview', 'é¢æ¥', 'é¢æ¥å¯¾ç­–ã®æ¼”ç¿’', 'ğŸ¤', '#F59E0B', 3),
(4, 'free_writing', 'è‡ªç”±è¨˜è¿°', 'è‡ªç”±è¨˜è¿°å•é¡Œã®æ¼”ç¿’', 'ğŸ“', '#8B5CF6', 4),
(5, 'english_reading', 'è‹±èªèª­è§£', 'åŒ»å­¦è‹±èªèª­è§£ã®æ¼”ç¿’', 'ğŸ“–', '#EF4444', 5);

-- æ¼”ç¿’ã‚¿ã‚¤ãƒ—ã®æŒ¿å…¥
INSERT INTO exercise_types (category_id, type_name, display_name, description, difficulty_level, estimated_duration_minutes, sort_order) VALUES
-- æ¡ç”¨è©¦é¨“ç³» (category_id = 1)
(1, 'prefecture_adoption', 'çœŒç·æ¡ç”¨è©¦é¨“', 'çœŒç«‹ç—…é™¢æ¡ç”¨è©¦é¨“å¯¾ç­–', 3, 45, 1),
(1, 'keyword_generation_adoption', 'æ¡ç”¨è©¦é¨“ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'æ¡ç”¨è©¦é¨“å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(1, 'paper_search_adoption', 'æ¡ç”¨è©¦é¨“ç”¨è«–æ–‡æ¤œç´¢', 'æ¡ç”¨è©¦é¨“å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- å°è«–æ–‡ç³» (category_id = 2)
(2, 'essay_practice', 'å°è«–æ–‡ç·´ç¿’', 'å°è«–æ–‡å¯¾ç­–ã®æ¼”ç¿’', 3, 60, 1),
(2, 'keyword_generation_essay', 'å°è«–æ–‡ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'å°è«–æ–‡å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(2, 'paper_search_essay', 'å°è«–æ–‡ç”¨è«–æ–‡æ¤œç´¢', 'å°è«–æ–‡å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- é¢æ¥ç³» (category_id = 3)
(3, 'interview_prep', 'é¢æ¥æº–å‚™', 'åŒ»å¸«é¢æ¥å¯¾ç­–', 3, 40, 1),
(3, 'keyword_generation_interview', 'é¢æ¥ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'é¢æ¥å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(3, 'paper_search_interview', 'é¢æ¥ç”¨è«–æ–‡æ¤œç´¢', 'é¢æ¥å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- è‡ªç”±è¨˜è¿°ç³» (category_id = 4)
(4, 'free_writing_practice', 'è‡ªç”±è¨˜è¿°ç·´ç¿’', 'åŒ»ç™‚ç¾å ´ã§ã®è‡ªç”±è¨˜è¿°å•é¡Œ', 4, 60, 1),
(4, 'keyword_generation_free', 'è‡ªç”±è¨˜è¿°ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'è‡ªç”±è¨˜è¿°å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(4, 'paper_search_free', 'è‡ªç”±è¨˜è¿°ç”¨è«–æ–‡æ¤œç´¢', 'è‡ªç”±è¨˜è¿°å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- è‹±èªèª­è§£ç³» (category_id = 5)
(5, 'english_reading_practice', 'è‹±èªèª­è§£ç·´ç¿’', 'åŒ»å­¦è«–æ–‡ã®è‹±èªèª­è§£', 2, 30, 1),
(5, 'keyword_generation_english', 'è‹±èªèª­è§£ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'è‹±èªèª­è§£å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(5, 'paper_search_english', 'è‹±èªèª­è§£ç”¨è«–æ–‡æ¤œç´¢', 'è‹±èªèª­è§£å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3);
```

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‡ãƒ¼ã‚¿ç§»è¡Œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ï¼š

```python
# migrate_existing_data.py
from modules.database_adapter_v3 import DatabaseAdapterV3

def migrate_existing_data():
    """æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã«ç§»è¡Œ"""
    adapter = DatabaseAdapterV3()
    
    # æ—¢å­˜ã®practice_sessionsã‚’exercise_sessionsã«ç§»è¡Œ
    # ã“ã®éƒ¨åˆ†ã¯æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦
    
    print("ãƒ‡ãƒ¼ã‚¿ç§»è¡ŒãŒå®Œäº†ã—ã¾ã—ãŸ")

if __name__ == "__main__":
    migrate_existing_data()
```

### ã‚¹ãƒ†ãƒƒãƒ—4: RLSãƒãƒªã‚·ãƒ¼ã®è¨­å®š

```sql
-- Row Level Securityã®æœ‰åŠ¹åŒ–
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_types ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_sessions ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_inputs ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_scores ENABLE ROW LEVEL SECURITY;
ALTER TABLE exercise_feedback ENABLE ROW LEVEL SECURITY;
ALTER TABLE category_keyword_history ENABLE ROW LEVEL SECURITY;
ALTER TABLE category_paper_search_history ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_statistics ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_activity_log ENABLE ROW LEVEL SECURITY;

-- ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
CREATE POLICY "Users can manage own data" ON users FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own sessions" ON exercise_sessions FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own inputs" ON exercise_inputs FOR ALL USING (
    session_id IN (SELECT session_id FROM exercise_sessions WHERE user_id = auth.uid())
);
CREATE POLICY "Users can manage own scores" ON exercise_scores FOR ALL USING (
    session_id IN (SELECT session_id FROM exercise_sessions WHERE user_id = auth.uid())
);
CREATE POLICY "Users can manage own feedback" ON exercise_feedback FOR ALL USING (
    session_id IN (SELECT session_id FROM exercise_sessions WHERE user_id = auth.uid())
);
CREATE POLICY "Users can manage own keyword history" ON category_keyword_history FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own paper search history" ON category_paper_search_history FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own statistics" ON user_statistics FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own activity log" ON user_activity_log FOR ALL USING (auth.uid() = user_id);

-- èª­ã¿å–ã‚Šå°‚ç”¨ãƒãƒªã‚·ãƒ¼ï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼ã¨ã‚¿ã‚¤ãƒ—ï¼‰
CREATE POLICY "Anyone can read categories" ON exercise_categories FOR SELECT USING (true);
CREATE POLICY "Anyone can read exercise types" ON exercise_types FOR SELECT USING (true);
```

---

## âœ… ç§»è¡Œå¾Œã®ç¢ºèª

### 1. ã‚¹ã‚­ãƒ¼ãƒç¢ºèª

```sql
-- æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã®å­˜åœ¨ç¢ºèª
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN (
    'users', 'exercise_categories', 'exercise_types', 'exercise_sessions',
    'exercise_inputs', 'exercise_scores', 'exercise_feedback',
    'category_keyword_history', 'category_paper_search_history',
    'user_statistics', 'user_activity_log'
);

-- ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
SELECT * FROM exercise_categories ORDER BY category_id;

-- æ¼”ç¿’ã‚¿ã‚¤ãƒ—ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
SELECT et.*, ec.display_name as category_name 
FROM exercise_types et 
JOIN exercise_categories ec ON et.category_id = ec.category_id 
ORDER BY et.category_id, et.sort_order;
```

### 2. Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‹•ä½œç¢ºèª

```python
from modules.database_adapter_v3 import DatabaseAdapterV3

# ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®åˆæœŸåŒ–
adapter = DatabaseAdapterV3()

# æ¥ç¶šç¢ºèª
if adapter.is_available():
    print("âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæˆåŠŸ")
else:
    print("âŒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šå¤±æ•—")

# ã‚«ãƒ†ã‚´ãƒªãƒ¼å–å¾—ç¢ºèª
categories = adapter.get_all_categories()
print(f"âœ… ã‚«ãƒ†ã‚´ãƒªãƒ¼æ•°: {len(categories)}")

# æ¼”ç¿’ã‚¿ã‚¤ãƒ—å–å¾—ç¢ºèª
exercise_types = adapter.get_all_exercise_types()
print(f"âœ… æ¼”ç¿’ã‚¿ã‚¤ãƒ—æ•°: {len(exercise_types)}")

# ãƒ†ã‚¹ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
test_session_id = adapter.create_session(
    user_id="test_user_123",
    exercise_type_name="prefecture_adoption"
)
if test_session_id:
    print(f"âœ… ãƒ†ã‚¹ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆæˆåŠŸ: {test_session_id}")
else:
    print("âŒ ãƒ†ã‚¹ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆå¤±æ•—")
```

### 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‹•ä½œç¢ºèª

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
streamlit run app.py

# å„ãƒšãƒ¼ã‚¸ã®å‹•ä½œç¢ºèª
# 1. çœŒç·æ¡ç”¨è©¦é¨“ãƒšãƒ¼ã‚¸
# 2. å°è«–æ–‡ãƒšãƒ¼ã‚¸
# 3. é¢æ¥ãƒšãƒ¼ã‚¸
# 4. è‡ªç”±è¨˜è¿°ãƒšãƒ¼ã‚¸
# 5. è‹±èªèª­è§£ãƒšãƒ¼ã‚¸
# 6. å­¦ç¿’å±¥æ­´ãƒšãƒ¼ã‚¸
# 7. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ãƒšãƒ¼ã‚¸
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ã‚¨ãƒ©ãƒ¼
```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨ç¢ºèª
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' AND table_name = 'exercise_categories';

-- å­˜åœ¨ã—ãªã„å ´åˆã¯ã‚¹ã‚­ãƒ¼ãƒä½œæˆã‚’å†å®Ÿè¡Œ
```

#### 2. ã‚«ãƒ†ã‚´ãƒªãƒ¼IDåˆ¶ç´„ã‚¨ãƒ©ãƒ¼
```sql
-- ã‚«ãƒ†ã‚´ãƒªãƒ¼IDã®ç¢ºèª
SELECT category_id, category_name FROM exercise_categories;

-- åˆ¶ç´„ã®ç¢ºèª
SELECT constraint_name, constraint_type 
FROM information_schema.table_constraints 
WHERE table_name = 'exercise_categories';
```

#### 3. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚¨ãƒ©ãƒ¼
```sql
-- å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®ç¢ºèª
SELECT 
    tc.table_name, 
    kcu.column_name, 
    ccu.table_name AS foreign_table_name,
    ccu.column_name AS foreign_column_name 
FROM information_schema.table_constraints AS tc 
JOIN information_schema.key_column_usage AS kcu
    ON tc.constraint_name = kcu.constraint_name
JOIN information_schema.constraint_column_usage AS ccu
    ON ccu.constraint_name = tc.constraint_name
WHERE constraint_type = 'FOREIGN KEY';
```

#### 4. RLSãƒãƒªã‚·ãƒ¼ã‚¨ãƒ©ãƒ¼
```sql
-- RLSãƒãƒªã‚·ãƒ¼ã®ç¢ºèª
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual 
FROM pg_policies 
WHERE schemaname = 'public';
```

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### 1. ãƒ­ã‚°ç¢ºèª
```python
import logging
logging.basicConfig(level=logging.DEBUG)

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã®ãƒ­ã‚°ã‚’ç¢ºèª
adapter = DatabaseAdapterV3()
categories = adapter.get_all_categories()
```

#### 2. æ¥ç¶šãƒ†ã‚¹ãƒˆ
```python
# æ¥ç¶šãƒ†ã‚¹ãƒˆ
def test_connection():
    try:
        adapter = DatabaseAdapterV3()
        if adapter.is_available():
            print("âœ… æ¥ç¶šæˆåŠŸ")
            return True
        else:
            print("âŒ æ¥ç¶šå¤±æ•—")
            return False
    except Exception as e:
        print(f"âŒ æ¥ç¶šã‚¨ãƒ©ãƒ¼: {e}")
        return False

test_connection()
```

#### 3. ãƒ‡ãƒ¼ã‚¿ç¢ºèª
```python
# ãƒ‡ãƒ¼ã‚¿ç¢ºèª
def check_data():
    adapter = DatabaseAdapterV3()
    
    # ã‚«ãƒ†ã‚´ãƒªãƒ¼ç¢ºèª
    categories = adapter.get_all_categories()
    print(f"ã‚«ãƒ†ã‚´ãƒªãƒ¼æ•°: {len(categories)}")
    
    # æ¼”ç¿’ã‚¿ã‚¤ãƒ—ç¢ºèª
    exercise_types = adapter.get_all_exercise_types()
    print(f"æ¼”ç¿’ã‚¿ã‚¤ãƒ—æ•°: {len(exercise_types)}")
    
    # ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆãƒ†ã‚¹ãƒˆ
    session_id = adapter.create_session("test_user", "prefecture_adoption")
    print(f"ãƒ†ã‚¹ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³: {session_id}")

check_data()
```

---

## ğŸ”„ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †

### ç·Šæ€¥æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

#### 1. æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰Šé™¤
```sql
-- æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ï¼ˆæ³¨æ„: ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¾ã™ï¼‰
DROP TABLE IF EXISTS user_activity_log CASCADE;
DROP TABLE IF EXISTS user_statistics CASCADE;
DROP TABLE IF EXISTS category_paper_search_history CASCADE;
DROP TABLE IF EXISTS category_keyword_history CASCADE;
DROP TABLE IF EXISTS exercise_feedback CASCADE;
DROP TABLE IF EXISTS exercise_scores CASCADE;
DROP TABLE IF EXISTS exercise_inputs CASCADE;
DROP TABLE IF EXISTS exercise_sessions CASCADE;
DROP TABLE IF EXISTS exercise_types CASCADE;
DROP TABLE IF EXISTS exercise_categories CASCADE;
```

#### 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ
```sql
-- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å…ƒã®åå‰ã«æˆ»ã™
ALTER TABLE practice_sessions_backup RENAME TO practice_sessions;
ALTER TABLE practice_inputs_backup RENAME TO practice_inputs;
ALTER TABLE practice_scores_backup RENAME TO practice_scores;
ALTER TABLE practice_feedback_backup RENAME TO practice_feedback;
```

#### 3. Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åˆ‡ã‚Šæ›¿ãˆ
```python
# å¤ã„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã«æˆ»ã™
from modules.database_adapter import DatabaseAdapter
adapter = DatabaseAdapter()
```

---

## ğŸ“‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ç§»è¡Œå‰
- [ ] æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
- [ ] ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åœæ­¢

### ç§»è¡Œä¸­
- [ ] æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã®ä½œæˆ
- [ ] åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥
- [ ] RLSãƒãƒªã‚·ãƒ¼ã®è¨­å®š
- [ ] ãƒ‡ãƒ¼ã‚¿ç§»è¡Œï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

### ç§»è¡Œå¾Œ
- [ ] ã‚¹ã‚­ãƒ¼ãƒã®ç¢ºèª
- [ ] Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‹•ä½œç¢ºèª
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ä½œç¢ºèª
- [ ] å„ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ
- [ ] å±¥æ­´æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

### æœ¬ç•ªç’°å¢ƒ
- [ ] æœ¬ç•ªç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ç¢ºèª
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ç¢ºèª
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é€šçŸ¥

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

ç§»è¡Œä¸­ã«å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã§å¯¾å¿œã—ã¦ãã ã•ã„ï¼š

1. **ãƒ­ã‚°ã®ç¢ºèª**: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è©³ç´°ã«è¨˜éŒ²
2. **çŠ¶æ…‹ã®ç¢ºèª**: ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹ã‚’ç¢ºèª
3. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**: å¿…è¦ã«å¿œã˜ã¦ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œ
4. **å†å®Ÿè¡Œ**: å•é¡Œã‚’ä¿®æ­£ã—ã¦å†å®Ÿè¡Œ

### ç·Šæ€¥é€£çµ¡å…ˆ
- é–‹ç™ºãƒãƒ¼ãƒ : [é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰](07_é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰.md)ã‚’å‚ç…§
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä»•æ§˜æ›¸](02_ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä»•æ§˜æ›¸.md)ã‚’å‚ç…§

---

*ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚æœ€æ–°ç‰ˆã¯GitHubãƒªãƒã‚¸ãƒˆãƒªã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚* 