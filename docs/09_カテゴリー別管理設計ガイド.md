# æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ç®¡ç†è¨­è¨ˆã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

ã“ã®è¨­è¨ˆã§ã¯ã€æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’1-5ã§ç®¡ç†ã—ã€ãã‚Œãã‚Œã«å¯¾ã—ã¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆã‚„è«–æ–‡æ¤œç´¢ã‚’ç´ã¥ã‘ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šåˆç†çš„ãªå±¥æ­´ç®¡ç†ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### ã‚«ãƒ†ã‚´ãƒªãƒ¼æ§‹æˆ

| ã‚«ãƒ†ã‚´ãƒªãƒ¼ID | ã‚«ãƒ†ã‚´ãƒªãƒ¼å | èª¬æ˜ | ã‚¢ã‚¤ã‚³ãƒ³ | è‰² |
|-------------|-------------|------|---------|-----|
| 1 | æ¡ç”¨è©¦é¨“ | åŒ»å¸«æ¡ç”¨è©¦é¨“å¯¾ç­–ã®æ¼”ç¿’ | ğŸ“‹ | #3B82F6 |
| 2 | å°è«–æ–‡ | å°è«–æ–‡å¯¾ç­–ã®æ¼”ç¿’ | âœï¸ | #10B981 |
| 3 | é¢æ¥ | é¢æ¥å¯¾ç­–ã®æ¼”ç¿’ | ğŸ¤ | #F59E0B |
| 4 | è‡ªç”±è¨˜è¿° | è‡ªç”±è¨˜è¿°å•é¡Œã®æ¼”ç¿’ | ğŸ“ | #8B5CF6 |
| 5 | è‹±èªèª­è§£ | åŒ»å­¦è‹±èªèª­è§£ã®æ¼”ç¿’ | ğŸ“– | #EF4444 |

## è¨­è¨ˆã®åˆ©ç‚¹

### 1. æ˜ç¢ºãªåˆ†é¡ç®¡ç†
- æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼ãŒ1-5ã§å›ºå®šç®¡ç†ã•ã‚Œã‚‹
- å„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«å¯¾ã—ã¦å¿…è¦ã«å¿œã˜ã¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆã‚„è«–æ–‡æ¤œç´¢ã‚’è¿½åŠ 
- å±¥æ­´ç®¡ç†ãŒæ˜ç¢ºã«ãªã‚‹

### 2. æŸ”è»Ÿãªæ¼”ç¿’ã‚¿ã‚¤ãƒ—ç®¡ç†
- å„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«å¯¾ã—ã¦è¤‡æ•°ã®æ¼”ç¿’ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šå¯èƒ½
- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆã‚„è«–æ–‡æ¤œç´¢ã‚‚æ¼”ç¿’ã‚¿ã‚¤ãƒ—ã¨ã—ã¦ç®¡ç†
- å°†æ¥çš„ãªæ‹¡å¼µãŒå®¹æ˜“

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸­å¿ƒã®å±¥æ­´ç®¡ç†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¨ã‚«ãƒ†ã‚´ãƒªãƒ¼IDã§å±¥æ­´ã‚’ç®¡ç†
- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®çµ±è¨ˆæƒ…å ±ã‚’æä¾›
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ã®ç´ä»˜ã‘ã‚‚å¯èƒ½

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«

#### 1. exercise_categoriesï¼ˆæ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼‰
```sql
CREATE TABLE exercise_categories (
    category_id INTEGER PRIMARY KEY CHECK (category_id BETWEEN 1 AND 5),
    category_name VARCHAR(50) NOT NULL UNIQUE,
    display_name VARCHAR(100) NOT NULL,
    description TEXT,
    icon VARCHAR(20),
    color VARCHAR(7),
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT true
);
```

#### 2. exercise_typesï¼ˆæ¼”ç¿’ã‚¿ã‚¤ãƒ—ï¼‰
```sql
CREATE TABLE exercise_types (
    exercise_type_id SERIAL PRIMARY KEY,
    category_id INTEGER NOT NULL REFERENCES exercise_categories(category_id),
    type_name VARCHAR(100) NOT NULL UNIQUE,
    display_name VARCHAR(150) NOT NULL,
    description TEXT,
    input_schema JSONB DEFAULT '{}',
    score_schema JSONB DEFAULT '{}',
    difficulty_level INTEGER DEFAULT 1,
    estimated_duration_minutes INTEGER DEFAULT 30,
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT true
);
```

#### 3. category_keyword_historyï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´ï¼‰
```sql
CREATE TABLE category_keyword_history (
    keyword_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(user_id) ON DELETE CASCADE,
    category_id INTEGER NOT NULL REFERENCES exercise_categories(category_id),
    session_id UUID REFERENCES exercise_sessions(session_id) ON DELETE CASCADE,
    input_text TEXT NOT NULL,
    generated_keywords TEXT[] NOT NULL,
    category VARCHAR(100),
    rationale TEXT,
    ai_model VARCHAR(50),
    tokens_used INTEGER,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### 4. category_paper_search_historyï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥è«–æ–‡æ¤œç´¢å±¥æ­´ï¼‰
```sql
CREATE TABLE category_paper_search_history (
    search_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(user_id) ON DELETE CASCADE,
    category_id INTEGER NOT NULL REFERENCES exercise_categories(category_id),
    session_id UUID REFERENCES exercise_sessions(session_id) ON DELETE CASCADE,
    search_query TEXT NOT NULL,
    search_keywords TEXT[],
    search_results JSONB NOT NULL,
    selected_papers JSONB,
    purpose TEXT,
    ai_model VARCHAR(50),
    tokens_used INTEGER,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

## Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½¿ç”¨æ–¹æ³•

### 1. ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®åˆæœŸåŒ–

```python
from modules.database_adapter_v3 import DatabaseAdapterV3

# ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ä½œæˆ
adapter = DatabaseAdapterV3()

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
if not adapter.is_available():
    print("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã§ãã¾ã›ã‚“")
    exit(1)
```

### 2. ã‚«ãƒ†ã‚´ãƒªãƒ¼ç®¡ç†

```python
# å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’å–å¾—
categories = adapter.get_all_categories()
for category in categories:
    print(f"ã‚«ãƒ†ã‚´ãƒªãƒ¼ {category.category_id}: {category.display_name}")

# ã‚«ãƒ†ã‚´ãƒªãƒ¼åã‹ã‚‰IDã‚’å–å¾—
category_id = adapter.get_category_id("æ¡ç”¨è©¦é¨“")  # 1
category_name = adapter.get_category_name(1)  # "æ¡ç”¨è©¦é¨“"

# ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®æ¼”ç¿’ã‚¿ã‚¤ãƒ—ã‚’å–å¾—
exercise_types = adapter.get_exercise_types_by_category(1)  # æ¡ç”¨è©¦é¨“ç³»
```

### 3. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´ã®ä¿å­˜

```python
# æ¡ç”¨è©¦é¨“ç”¨ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´ã‚’ä¿å­˜
keyword_id = adapter.save_keyword_history(
    user_id="user123",
    category_name="æ¡ç”¨è©¦é¨“",
    input_text="åŒ»ç™‚ç¾å ´ã§ã®èª²é¡Œã«ã¤ã„ã¦",
    generated_keywords=["åŒ»ç™‚å®‰å…¨", "æ‚£è€…ã‚±ã‚¢", "ãƒãƒ¼ãƒ åŒ»ç™‚"],
    session_id="session456",
    rationale="æ¡ç”¨è©¦é¨“å¯¾ç­–ç”¨",
    ai_model="gpt-4"
)

if keyword_id:
    print(f"ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´ã‚’ä¿å­˜ã—ã¾ã—ãŸ: {keyword_id}")
```

### 4. è«–æ–‡æ¤œç´¢å±¥æ­´ã®ä¿å­˜

```python
# å°è«–æ–‡ç”¨ã®è«–æ–‡æ¤œç´¢å±¥æ­´ã‚’ä¿å­˜
search_id = adapter.save_paper_search_history(
    user_id="user123",
    category_name="å°è«–æ–‡",
    search_query="åŒ»ç™‚ç¾å ´ã§ã®èª²é¡Œ",
    search_keywords=["åŒ»ç™‚å®‰å…¨", "æ‚£è€…ã‚±ã‚¢"],
    search_results={
        "papers": [
            {"title": "åŒ»ç™‚å®‰å…¨ã®ç¾çŠ¶ã¨èª²é¡Œ", "authors": "ç”°ä¸­å¤ªéƒ", "year": 2023},
            {"title": "æ‚£è€…ã‚±ã‚¢ã®æ”¹å–„æ–¹æ³•", "authors": "ä½è—¤èŠ±å­", "year": 2022}
        ]
    },
    session_id="session456",
    purpose="å°è«–æ–‡å¯¾ç­–ç”¨",
    ai_model="gpt-4"
)

if search_id:
    print(f"è«–æ–‡æ¤œç´¢å±¥æ­´ã‚’ä¿å­˜ã—ã¾ã—ãŸ: {search_id}")
```

### 5. å±¥æ­´ã®å–å¾—

```python
# ç‰¹å®šã‚«ãƒ†ã‚´ãƒªãƒ¼ã®å±¥æ­´ã‚’å–å¾—
keyword_history, paper_search_history = get_category_history(
    adapter, 
    user_id="user123", 
    category_name="æ¡ç”¨è©¦é¨“"
)

print(f"ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´: {len(keyword_history)}ä»¶")
print(f"è«–æ–‡æ¤œç´¢å±¥æ­´: {len(paper_search_history)}ä»¶")

# å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®å±¥æ­´ã‚’å–å¾—
keyword_history, paper_search_history = get_category_history(
    adapter, 
    user_id="user123"
)
```

### 6. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

```python
# æ¼”ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
session_id = adapter.create_session(
    user_id="user123",
    exercise_type_name="prefecture_adoption",  # çœŒç·æ¡ç”¨è©¦é¨“
    theme="åŒ»ç™‚ç¾å ´ã§ã®èª²é¡Œ"
)

if session_id:
    print(f"ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸ: {session_id}")
    
    # ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’æ›´æ–°
    adapter.update_session_status(session_id, "completed", 100.0)
```

### 7. çµ±è¨ˆæƒ…å ±ã®å–å¾—

```python
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
statistics = adapter.get_user_statistics("user123")

for stat in statistics:
    category_name = adapter.get_category_name(stat.category_id)
    print(f"{category_name}: {stat.total_sessions}å›ã®æ¼”ç¿’")

# ç‰¹å®šã‚«ãƒ†ã‚´ãƒªãƒ¼ã®çµ±è¨ˆã‚’å–å¾—
adoption_stats = adapter.get_category_statistics("user123", "æ¡ç”¨è©¦é¨“")
if adoption_stats:
    print(f"æ¡ç”¨è©¦é¨“æ¼”ç¿’: {adoption_stats.total_sessions}å›")
```

## ç§»è¡Œã‚¬ã‚¤ãƒ‰

### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®ç§»è¡Œ

```python
# å¤ã„ç·´ç¿’ã‚¿ã‚¤ãƒ—ã‚’æ–°ã—ã„æ¼”ç¿’ã‚¿ã‚¤ãƒ—ã«ç§»è¡Œ
old_type = "æ¡ç”¨è©¦é¨“"
new_type = adapter.migrate_old_practice_type(old_type)
category_name = adapter.get_category_for_old_practice_type(old_type)

print(f"å¤ã„ã‚¿ã‚¤ãƒ— '{old_type}' â†’ æ–°ã—ã„ã‚¿ã‚¤ãƒ— '{new_type}'")
print(f"ã‚«ãƒ†ã‚´ãƒªãƒ¼: {category_name}")
```

### ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã‚µãƒãƒªãƒ¼ã®å–å¾—

```python
# ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®è©³ç´°æƒ…å ±ã‚’å–å¾—
summary = adapter.get_category_summary()

for category in summary:
    print(f"{category.display_name}: {category.total_exercise_types}ç¨®é¡ã®æ¼”ç¿’")
```

## åˆæœŸãƒ‡ãƒ¼ã‚¿

### æ¼”ç¿’ã‚«ãƒ†ã‚´ãƒªãƒ¼
```sql
INSERT INTO exercise_categories (category_id, category_name, display_name, description, icon, color, sort_order) VALUES
(1, 'adoption_exam', 'æ¡ç”¨è©¦é¨“', 'åŒ»å¸«æ¡ç”¨è©¦é¨“å¯¾ç­–ã®æ¼”ç¿’', 'ğŸ“‹', '#3B82F6', 1),
(2, 'essay_writing', 'å°è«–æ–‡', 'å°è«–æ–‡å¯¾ç­–ã®æ¼”ç¿’', 'âœï¸', '#10B981', 2),
(3, 'interview', 'é¢æ¥', 'é¢æ¥å¯¾ç­–ã®æ¼”ç¿’', 'ğŸ¤', '#F59E0B', 3),
(4, 'free_writing', 'è‡ªç”±è¨˜è¿°', 'è‡ªç”±è¨˜è¿°å•é¡Œã®æ¼”ç¿’', 'ğŸ“', '#8B5CF6', 4),
(5, 'english_reading', 'è‹±èªèª­è§£', 'åŒ»å­¦è‹±èªèª­è§£ã®æ¼”ç¿’', 'ğŸ“–', '#EF4444', 5);
```

### æ¼”ç¿’ã‚¿ã‚¤ãƒ—
```sql
INSERT INTO exercise_types (category_id, type_name, display_name, description, difficulty_level, estimated_duration_minutes, sort_order) VALUES
-- æ¡ç”¨è©¦é¨“ç³» (category_id = 1)
(1, 'prefecture_adoption', 'çœŒç·æ¡ç”¨è©¦é¨“', 'çœŒç«‹ç—…é™¢æ¡ç”¨è©¦é¨“å¯¾ç­–', 3, 45, 1),
(1, 'keyword_generation_adoption', 'æ¡ç”¨è©¦é¨“ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'æ¡ç”¨è©¦é¨“å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(1, 'paper_search_adoption', 'æ¡ç”¨è©¦é¨“ç”¨è«–æ–‡æ¤œç´¢', 'æ¡ç”¨è©¦é¨“å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- å°è«–æ–‡ç³» (category_id = 2)
(2, 'essay_practice', 'å°è«–æ–‡ç·´ç¿’', 'å°è«–æ–‡å¯¾ç­–ã®æ¼”ç¿’', 3, 60, 1),
(2, 'keyword_generation_essay', 'å°è«–æ–‡ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'å°è«–æ–‡å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(2, 'paper_search_essay', 'å°è«–æ–‡ç”¨è«–æ–‡æ¤œç´¢', 'å°è«–æ–‡å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- é¢æ¥ç³» (category_id = 3)
(3, 'interview_prep', 'é¢æ¥æº–å‚™', 'åŒ»å¸«é¢æ¥å¯¾ç­–', 3, 40, 1),
(3, 'keyword_generation_interview', 'é¢æ¥ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'é¢æ¥å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(3, 'paper_search_interview', 'é¢æ¥ç”¨è«–æ–‡æ¤œç´¢', 'é¢æ¥å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- è‡ªç”±è¨˜è¿°ç³» (category_id = 4)
(4, 'free_writing_practice', 'è‡ªç”±è¨˜è¿°ç·´ç¿’', 'åŒ»ç™‚ç¾å ´ã§ã®è‡ªç”±è¨˜è¿°å•é¡Œ', 4, 60, 1),
(4, 'keyword_generation_free', 'è‡ªç”±è¨˜è¿°ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'è‡ªç”±è¨˜è¿°å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(4, 'paper_search_free', 'è‡ªç”±è¨˜è¿°ç”¨è«–æ–‡æ¤œç´¢', 'è‡ªç”±è¨˜è¿°å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3),

-- è‹±èªèª­è§£ç³» (category_id = 5)
(5, 'english_reading_practice', 'è‹±èªèª­è§£ç·´ç¿’', 'åŒ»å­¦è«–æ–‡ã®è‹±èªèª­è§£', 2, 30, 1),
(5, 'keyword_generation_english', 'è‹±èªèª­è§£ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 'è‹±èªèª­è§£å¯¾ç­–ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ', 2, 15, 2),
(5, 'paper_search_english', 'è‹±èªèª­è§£ç”¨è«–æ–‡æ¤œç´¢', 'è‹±èªèª­è§£å¯¾ç­–ç”¨è«–æ–‡æ¤œç´¢', 2, 20, 3);
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### Row Level Security (RLS)
ã™ã¹ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§RLSã‚’æœ‰åŠ¹åŒ–ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼š

```sql
-- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥å±¥æ­´
CREATE POLICY "Users can manage own keyword history" ON category_keyword_history FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Users can manage own paper search history" ON category_paper_search_history FOR ALL USING (auth.uid() = user_id);
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
```sql
-- å±¥æ­´é–¢é€£ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_category_keyword_user_category 
ON category_keyword_history(user_id, category_id, created_at DESC);

CREATE INDEX idx_category_paper_search_user_category 
ON category_paper_search_history(user_id, category_id, created_at DESC);
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **ã‚«ãƒ†ã‚´ãƒªãƒ¼IDãŒå­˜åœ¨ã—ãªã„**
   - ã‚«ãƒ†ã‚´ãƒªãƒ¼IDã¯1-5ã®ç¯„å›²ã§å›ºå®š
   - å­˜åœ¨ã—ãªã„ã‚«ãƒ†ã‚´ãƒªãƒ¼IDã‚’ä½¿ç”¨ã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼

2. **å±¥æ­´ãŒä¿å­˜ã•ã‚Œãªã„**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¨ã‚«ãƒ†ã‚´ãƒªãƒ¼IDã®çµ„ã¿åˆã‚ã›ã‚’ç¢ºèª
   - RLSãƒãƒªã‚·ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

3. **çµ±è¨ˆæƒ…å ±ãŒæ›´æ–°ã•ã‚Œãªã„**
   - ãƒˆãƒªã‚¬ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ãŒ'completed'ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

```python
# ã‚«ãƒ†ã‚´ãƒªãƒ¼æƒ…å ±ã®ç¢ºèª
categories = adapter.get_all_categories()
print("åˆ©ç”¨å¯èƒ½ãªã‚«ãƒ†ã‚´ãƒªãƒ¼:")
for cat in categories:
    print(f"  {cat.category_id}: {cat.display_name}")

# å±¥æ­´ã®ç¢ºèª
keyword_history = adapter.get_keyword_history("user123", "æ¡ç”¨è©¦é¨“")
print(f"ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå±¥æ­´: {len(keyword_history)}ä»¶")

# çµ±è¨ˆæƒ…å ±ã®ç¢ºèª
stats = adapter.get_user_statistics("user123")
print(f"çµ±è¨ˆæƒ…å ±: {len(stats)}ä»¶")
```

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚æœ€æ–°ç‰ˆã¯GitHubãƒªãƒã‚¸ãƒˆãƒªã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚* 